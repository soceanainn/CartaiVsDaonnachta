<!DOCTYPE html>
<html lang="ie">
<head>
    <title>Éire Aontaithe (Risk)</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">
</head>
<body>
<header>
    <nav class="navbar navbar-expand-md navbar-light fixed-top bg-light border-bottom shadow-sm">
        <a class="navbar-brand" href="/">
            <img src="/client/assets/images/controller.svg" alt="Controller icon" width="36" height="36" title="Baile"/>
            Cluichí as Gaeilge
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarCollapse">
            <a class="p-2 btn btn-light" href="/boggle">Boggle</a>
            <a class="p-2 btn btn-light active" href="#">Éire Aontaithe (Risk)</a>
            <a class="p-2 btn btn-outline-primary" href="/eolas">Eolas</a>
        </div>
    </nav>
</header>
<main role="main" class="container mt-5 pt-5">
    <div class="row">
        <div class=" col-xs-12 col-sm-7 col-md-6 col-lg-5" style="text-align: center;">
            <h2>Éire Aontaithe (Risk)</h2>
            <canvas id="canvas" style="width: 100%;"></canvas>
        </div>
    </div>
</main>
<footer class="footer" style="text-align: center;">
        <span class="text-muted">Cruthaithe ag:
            <a class="text-dark" href="mailto: seamusoceanainn@gmail.com">
                <img src="/client/assets/images/envelope.svg" alt="Email icon" width="16" height="16" title="Seol ríomhphost"/>
                Séamus Ó Ceanainn
            </a>
        </span>
</footer>
</body>

<script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    let ratio = 0;
    if (typeof ctx.filter === "undefined") {
        alert("Níl an brabhsálaí seo oiriúnach don cluiche seo!")
    }

    const img = new Image;
    img.onload = function() {
        const oc = document.createElement('canvas');
        const octx = oc.getContext('2d');
        oc.width = this.width;
        oc.height = this.height;

        const steps = (oc.width / canvas.width)>>1;
        octx.filter = `blur(${steps}px)`;
        octx.drawImage(this, 0, 0);

        ratio = (canvas.width / oc.width);
        canvas.width = oc.width * ratio;
        canvas.height = oc.height * ratio;
        ctx.drawImage(oc, 0, 0, oc.width, oc.height, 0, 0, canvas.width, canvas.height);

        drawCircles();
    };
    img.src = 'client/risk/assets/ireland.svg';

    const leinster = {
        "kildare": {"x": 1010, "y": 980, "troops": null, "owner": null},
        "louth": {"x": 1130, "y": 700, "troops": null, "owner": null},
        "meath": {"x": 1040, "y": 800, "troops": null, "owner": null},
        "wexford": {"x": 1060, "y": 1300, "troops": null, "owner": null},
        "westmeath": {"x": 880, "y": 850, "troops": null, "owner": null},
        "longford": {"x": 790, "y": 770, "troops": null, "owner": null},
        "offaly": {"x": 790, "y": 980, "troops": null, "owner": null},
        "laois": {"x": 880, "y": 1060, "troops": null, "owner": null},
        "kilkenny": {"x": 920, "y": 1250, "troops": null, "owner": null},
        "wicklow": {"x": 1130, "y": 1060, "troops": null, "owner": null},
        "carlow": {"x": 1010, "y": 1150, "troops": null, "owner": null},
        "dublin": {"x": 1150, "y": 910, "troops": null, "owner": null}
    };

    const munster = {
        "cork": {"x": 550, "y": 1480, "troops": null, "owner": null},
        "limerick": {"x": 540, "y": 1260, "troops": null, "owner": null},
        "clare": {"x": 470, "y": 1130, "troops": null, "owner": null},
        "tipperary": {"x": 750, "y": 1250, "troops": null, "owner": null},
        "waterford": {"x": 820, "y": 1400, "troops": null, "owner": null},
        "kerry": {"x": 360, "y": 1400, "troops": null, "owner": null}
    };

    const connaught = {
        "mayo": {"x": 450, "y": 700, "troops": null, "owner": null},
        "leitrim": {"x": 750, "y": 630, "troops": null, "owner": null},
        "sligo": {"x": 570, "y": 580, "troops": null, "owner": null},
        "roscommon": {"x": 650, "y": 725, "troops": null, "owner": null},
        "galway": {"x": 570, "y": 900, "troops": null, "owner": null}
    };

    const ulster = {
        "donegal": {"x": 720, "y": 300, "troops": null, "owner": null},
        "fermanagh": {"x": 800, "y": 500, "troops": null, "owner": null},
        "tyrone": {"x": 930, "y": 400, "troops": null, "owner": null},
        "derry": {"x": 1000, "y": 250, "troops": null, "owner": null},
        "antrim": {"x": 1165, "y": 300, "troops": null, "owner": null},
        "down": {"x": 1200, "y": 500, "troops": null, "owner": null},
        "armagh": {"x": 1070, "y": 530, "troops": null, "owner": null},
        "monaghan": {"x": 970, "y": 580, "troops": null, "owner": null},
        "cavan": {"x": 900, "y": 680, "troops": null, "owner": null}
    };

    function drawCircles(){
        for (l in leinster) drawCircle(leinster[l].x, leinster[l].y, 1, 0);
        for (m in munster) drawCircle(munster[m].x, munster[m].y, 10, 1);
        for (c in connaught) drawCircle(connaught[c].x, connaught[c].y, 3, 2);
        for (u in ulster) drawCircle(ulster[u].x, ulster[u].y, ulster[u].troops, ulster[u].owner);
    }

    function ownerColor(owner) {
        switch(owner){
            case 0: return 'green';
            case 1: return 'blue';
            case 2: return 'orange';
            default: return 'grey';
        }
    }

    function drawTroopNumbers(number, x, y) {
        if (number !== null) {
            ctx.beginPath();
            ctx.fillStyle = '#000';
            if (number < 10) ctx.fillText(number.toString(), (x * ratio) - 2.5, (y * ratio) + 3);
            else ctx.fillText(number.toString(), (x * ratio) - 5, (y * ratio) + 3);
            ctx.fill();
        }
    }

    function drawCircle(x, y, number, owner) {
        ctx.beginPath();
        ctx.arc(x * ratio, y * ratio, 10, 0, 2 * Math.PI, false);
        ctx.fillStyle = '#FFF';
        ctx.fill();
        ctx.lineWidth = 5;

        ctx.strokeStyle = ownerColor(owner);
        ctx.stroke();

        drawTroopNumbers(number, x, y);
    }
</script>
<link href="/client/assets/custom-styling.css" rel="stylesheet">
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8=" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js" integrity="sha384-6khuMg9gaYr5AxOqhkVIODVIvm9ynTT5J4V1cfthmT+emCG6yVmEZsRHdxlotUnm" crossorigin="anonymous"></script>
</html>
